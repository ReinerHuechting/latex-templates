\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{framesections}[2022/05/01 Frame Sections]
\RequirePackage{xparse}
\RequirePackage{xifthen}

\def\insertframesection{}
\def\@nosframetitlewarning{\alert{Warning: No title for frame section}}
\def\insertframesection{\@nosframetitlewarning}

% Environment for a series of frames with a common title.
% #1: Common title for all frames in this series
\newenvironment{framesection}[1]{
  \def\insertframesection{#1}
}{
}

% Environment for a frame that uses the current framesection title.
\NewDocumentEnvironment{sframe}{b}{
  \ifthenelse{\equal{\insertframesection}{\@nosframetitlewarning}}{
    \PackageWarning{framesections}{
      sframe outside of a framesection. The frame will not have a valid title.}
  }{
  }
}{
  \begin{frame}{\insertframesection}
    #1
  \end{frame}
}

% TODO: Collect all warnings and summarize them in the end?
%       That might simplify development.
